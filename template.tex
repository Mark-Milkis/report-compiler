\documentclass[11pt,a4paper]{article}

% Essential packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}

% Page layout and geometry
\usepackage[margin=1in]{geometry}

% Graphics and PDF inclusion
\usepackage{graphicx}
\usepackage{pdfpages}

% Math support
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

% Table support
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}

% Headers and footers
\usepackage{fancyhdr}
\pagestyle{fancy}

% Configure headers and footers
\fancyhf{} % Clear all header and footer fields
\fancyhead[L]{$if(company)$$company$$else$Engineering Report$endif$}
\fancyhead[R]{$if(title)$$title$$endif$}
\fancyfoot[C]{\thepage}

% Line spacing
\usepackage{setspace}
\onehalfspacing

% Colors
\usepackage{xcolor}

% Hyperlinks
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    citecolor=blue,
    pdfborder={0 0 0}
}

% Lists
\usepackage{enumerate}
\usepackage{enumitem}

% Code highlighting (if needed)
\usepackage{listings}
\usepackage{fancyvrb}

% Pandoc syntax highlighting
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% Title and author information
$if(title)$
\title{$title$}
$endif$

$if(author)$
\author{$for(author)$$author$$sep$ \and $endfor$}
$endif$

$if(date)$
\date{$date$}
$else$
\date{\today}
$endif$

% Custom commands
\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} % Create horizontal rule command

\begin{document}

% Title page
$if(title)$
\begin{titlepage}
    \centering
    \vspace*{0.5cm}
    
    $if(company)$
    {\Large \textbf{$company$}}\\[0.5cm]
    $endif$
    
    \horrule{0.5pt} \\[0.4cm]
    {\huge \bfseries $title$}\\[0.2cm]
    \horrule{2pt} \\[1.5cm]
    
    $if(subtitle)$
    {\Large $subtitle$}\\[1cm]
    $endif$
    
    $if(author)$
    {\large
    $for(author)$
    $author$\\
    $endfor$
    }\\[1cm]
    $endif$
    
    $if(department)$
    {\large $department$}\\[0.5cm]
    $endif$
    
    \vfill
    
    $if(date)$
    {\large $date$}
    $else$
    {\large \today}
    $endif$
    
\end{titlepage}
$else$
$if(author)$
\maketitle
$endif$
$endif$

% Table of contents
$if(toc)$
\newpage
\tableofcontents
\newpage
$endif$

% List of figures (optional)
$if(lof)$
\listoffigures
\newpage
$endif$

% List of tables (optional)
$if(lot)$
\listoftables
\newpage
$endif$

% Main document body
$body$

\end{document}
