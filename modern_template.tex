\documentclass[11pt,a4paper]{article}

% Modern packages for enhanced styling
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}

% Page layout and geometry
\usepackage[margin=1in, top=1.2in, bottom=1.2in]{geometry}

% Colors and graphics
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{pdfpages}

% Define vibrant modern color palette
\definecolor{primaryblue}{RGB}{0, 123, 255}       % Vibrant blue
\definecolor{secondaryblue}{RGB}{108, 117, 125}   % Modern gray-blue
\definecolor{accentorange}{RGB}{255, 87, 34}      % Bright orange
\definecolor{accentpurple}{RGB}{156, 39, 176}     % Modern purple
\definecolor{accentteal}{RGB}{0, 150, 136}        % Teal accent
\definecolor{darkgray}{RGB}{33, 37, 41}           % Dark charcoal
\definecolor{lightgray}{RGB}{108, 117, 125}       % Modern gray
\definecolor{backgroundgray}{RGB}{248, 249, 250}  % Ultra-light background
\definecolor{successgreen}{RGB}{40, 167, 69}      % Success green
\definecolor{warningyellow}{RGB}{255, 193, 7}     % Warning yellow
\definecolor{dangerred}{RGB}{220, 53, 69}         % Danger red

% Typography and spacing
\usepackage{setspace}
\usepackage{parskip}
\setlength{\parskip}{0.6em}
\setlength{\parindent}{0pt}
\onehalfspacing

% Enhanced math support
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

% Better tables
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}
\usepackage{tabularx}

% Enhanced lists and enumerations with colors
\usepackage{enumitem}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}

% Custom list styling with vibrant colors
\setlist[itemize,1]{label=\textcolor{primaryblue}{\textbullet}}
\setlist[itemize,2]{label=\textcolor{accentteal}{\textendash}}
\setlist[itemize,3]{label=\textcolor{accentorange}{\textasteriskcentered}}
\setlist[enumerate,1]{label=\textcolor{primaryblue}{\arabic*.}}
\setlist[enumerate,2]{label=\textcolor{accentpurple}{\alph*)}}

% Enhanced table styling with colors
\usepackage{colortbl}

% Custom table commands for colorful tables
\newcommand{\tableheader}[1]{\rowcolor{primaryblue!20}\textbf{\color{darkgray}#1}}
\newcommand{\tablealt}{\rowcolor{backgroundgray}}

% Headers and footers with fancy styling
\usepackage{fancyhdr}
\usepackage{lastpage}

% Section formatting with colors
\usepackage{sectsty}

% Modern section styling with gradient-like colors
\sectionfont{\LARGE\bfseries\color{primaryblue}}
\subsectionfont{\Large\bfseries\color{accentpurple}}
\subsubsectionfont{\large\bfseries\color{accentteal}}

% Hyperlinks
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=primaryblue,
    filecolor=accentorange,      
    urlcolor=secondaryblue,
    citecolor=primaryblue,
    pdfborder={0 0 0},
    bookmarksnumbered=true,
    bookmarksopen=true
}

% Code highlighting
\usepackage{listings}
\usepackage{fancyvrb}

% Pandoc syntax highlighting
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% Enhanced custom commands for vibrant styling
\newcommand{\highlight}[1]{\colorbox{successgreen!20}{\textbf{#1}}}
\newcommand{\important}[1]{\textcolor{accentorange}{\textbf{#1}}}
\newcommand{\note}[1]{\textcolor{accentteal}{\textit{#1}}}
\newcommand{\warning}[1]{\colorbox{warningyellow!20}{\textcolor{darkgray}{\textbf{#1}}}}
\newcommand{\danger}[1]{\colorbox{dangerred!20}{\textcolor{dangerred}{\textbf{#1}}}}
\newcommand{\success}[1]{\colorbox{successgreen!20}{\textcolor{successgreen}{\textbf{#1}}}}

% Title and metadata
$if(title)$
\title{$title$}
$endif$

$if(author)$
\author{$for(author)$$author$$sep$ \and $endfor$}
$endif$

$if(date)$
\date{$date$}
$else$
\date{\today}
$endif$

% Custom header and footer design
\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields

% Creative header with gradient-like effect
\fancyhead[L]{%
    \begin{tikzpicture}[remember picture,overlay]
        \fill[primaryblue] (0,0) rectangle (6cm,0.8cm);
        \fill[accentpurple] (6cm,0) rectangle (8cm,0.8cm);
    \end{tikzpicture}%
    \raisebox{0.2cm}{\color{white}\bfseries\hspace{0.5em}$if(company)$$company$$else$ENGINEERING SOLUTIONS$endif$\hspace{0.5em}}%
}
\fancyhead[R]{%
    \raisebox{0.1cm}{%
        \colorbox{accentteal!20}{%
            \color{accentteal}\small\bfseries\hspace{0.3em}$if(project)$$project$$else$$if(title)$$title$$endif$$endif$\hspace{0.3em}%
        }%
    }%
}

% Creative footer with modern design
\fancyfoot[L]{%
    \colorbox{secondaryblue!10}{%
        \color{secondaryblue}\small\hspace{0.3em}$if(department)$$department$$else$Technical Report$endif$\hspace{0.3em}%
    }%
}
\fancyfoot[C]{%
    \begin{tikzpicture}[baseline=(current bounding box.center)]
        \fill[primaryblue] (0,0) rectangle (2.5cm,0.6cm);
        \node[white,font=\bfseries] at (1.25cm,0.3cm) {\small Page \thepage\ of \pageref{LastPage}};
    \end{tikzpicture}%
}
\fancyfoot[R]{%
    \colorbox{accentorange!10}{%
        \color{accentorange}\small\hspace{0.3em}$if(date)$$date$$else$\today$endif$\hspace{0.3em}%
    }%
}

% Enhanced header and footer rules with gradients
\renewcommand{\headrulewidth}{0pt} % Remove default rule, we'll use TikZ
\renewcommand{\footrulewidth}{2pt}
\renewcommand{\footrule}{%
    \begin{tikzpicture}[remember picture,overlay]
        \fill[accentteal] (0,0) rectangle (\textwidth,2pt);
    \end{tikzpicture}%
}

% Adjust header and footer heights for enhanced design
\setlength{\headheight}{1.5cm}
\setlength{\footskip}{1.2cm}

% Ultra-modern title page design with creative elements
\renewcommand{\maketitle}{%
    \begin{titlepage}
        % Background design elements
        \begin{tikzpicture}[remember picture,overlay]
            % Top gradient bar
            \fill[primaryblue] (current page.north west) rectangle ([yshift=-2cm]current page.north east);
            \fill[accentpurple] (current page.north west) rectangle ([yshift=-1cm]current page.north east);
            
            % Bottom accent
            \fill[accentteal] ([yshift=2cm]current page.south west) rectangle (current page.south east);
            
            % Decorative circles
            \fill[accentorange!30] ([xshift=-3cm,yshift=-8cm]current page.north east) circle (4cm);
            \fill[successgreen!20] ([xshift=2cm,yshift=-15cm]current page.north west) circle (3cm);
        \end{tikzpicture}
        
        \begin{center}
            \vspace*{3cm}
            
            % Company logo area
            $if(logo)$
            \includegraphics[width=0.3\textwidth]{$logo$}\\[1cm]
            $endif$
            
            % Main title with ultra-modern styling
            \colorbox{white}{%
                \begin{minipage}{0.9\textwidth}
                    \centering
                    \vspace{0.5cm}
                    {\Huge\bfseries\color{primaryblue}$if(title)$$title$$endif$\par}
                    \vspace{0.5cm}
                \end{minipage}
            }
            \vspace{0.5cm}
            
            % Subtitle with modern accent
            $if(subtitle)$
            {\LARGE\color{accentpurple}\textit{$subtitle$}\par}
            \vspace{1cm}
            $endif$
            
            % Creative decorative element
            \begin{tikzpicture}
                \draw[line width=3pt,primaryblue] (0,0) -- (8cm,0);
                \draw[line width=2pt,accentorange] (0,0.2cm) -- (6cm,0.2cm);
                \draw[line width=1pt,accentteal] (0,0.4cm) -- (4cm,0.4cm);
            \end{tikzpicture}\\[1.5cm]
            
            % Author information in ultra-modern style
            $if(author)$
            \begin{tikzpicture}
                \fill[backgroundgray] (0,0) rectangle (10cm,3cm);
                \fill[primaryblue!10] (0,0) rectangle (10cm,0.5cm);
                \node[anchor=center] at (5cm,2cm) {
                    \begin{minipage}{8cm}
                        \centering
                        {\large\bfseries\color{darkgray}Prepared by:}\\[0.3cm]
                        {\Large\color{primaryblue}$for(author)$$author$$sep$ \\ $endfor$}
                    \end{minipage}
                };
            \end{tikzpicture}\\[1.5cm]
            $endif$
            
            % Company and department info with modern styling
            $if(company)$
            \colorbox{accentteal!20}{%
                \begin{minipage}{0.6\textwidth}
                    \centering
                    \vspace{0.3cm}
                    {\large\bfseries\color{accentteal}$company$}
                    \vspace{0.3cm}
                \end{minipage}
            }\\[0.5cm]
            $endif$
            $if(department)$
            {\color{secondaryblue}$department$}\\[1cm]
            $endif$
            
            \vfill
            
            % Date with ultra-modern design
            \begin{tikzpicture}
                \fill[accentorange] (0,0) rectangle (6cm,1.5cm);
                \fill[accentorange!70] (0,0) rectangle (6cm,0.5cm);
                \node[white,font=\Large\bfseries] at (3cm,0.75cm) {$if(date)$$date$$else$\today$endif$};
            \end{tikzpicture}
            
            \vspace{1cm}
        \end{center}
    \end{titlepage}
    \setcounter{page}{2} % Start page numbering from 2
}

\begin{document}

% Title page
$if(title)$
\maketitle
$endif$

% Table of contents with modern styling
$if(toc)$
\newpage
{\color{primaryblue}\tableofcontents}
\newpage
$endif$

% List of figures (optional)
$if(lof)$
{\color{primaryblue}\listoffigures}
\newpage
$endif$

% List of tables (optional)
$if(lot)$
{\color{primaryblue}\listoftables}
\newpage
$endif$

% Main document body
$body$

% Back cover with enhanced creative design
\newpage
\thispagestyle{empty}

% Creative back cover design
\begin{tikzpicture}[remember picture,overlay]
    % Background gradient effect
    \fill[accentteal!20] (current page.south west) rectangle (current page.north east);
    \fill[primaryblue!10] (current page.south west) rectangle ([yshift=8cm]current page.north east);
    
    % Decorative elements
    \fill[accentorange!30] ([xshift=15cm,yshift=-5cm]current page.south west) circle (6cm);
    \fill[accentpurple!20] ([xshift=-2cm,yshift=10cm]current page.south west) circle (5cm);
\end{tikzpicture}

\vspace*{\fill}
\begin{center}
    \begin{tikzpicture}
        % Main content box
        \fill[white] (0,0) rectangle (12cm,6cm);
        \fill[primaryblue] (0,5cm) rectangle (12cm,6cm);
        
        % Content
        \node[anchor=center] at (6cm,5.5cm) {
            {\Large\bfseries\color{white}Professional Engineering Report}
        };
        
        \node[anchor=center] at (6cm,3.5cm) {
            \begin{minipage}{10cm}
                \centering
                {\large\color{primaryblue}\textbf{Advanced Report Compiler System}}\\[0.5cm]
                {\color{darkgray}Seamlessly integrating Word documents, PDF appendices,}\\
                {\color{darkgray}and professional LaTeX typesetting}\\[1cm]
                
                \colorbox{accentteal!20}{%
                    \begin{minipage}{8cm}
                        \centering
                        \vspace{0.3cm}
                        {\color{accentteal}\bfseries $if(company)$$company$$else$Engineering Solutions$endif$}\\
                        {\small\color{secondaryblue}$if(date)$$date$$else$\today$endif$}
                        \vspace{0.3cm}
                    \end{minipage}
                }
            \end{minipage}
        };
    \end{tikzpicture}
\end{center}
\vspace*{\fill}

\end{document}
