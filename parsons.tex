% ===================================================================
% LaTeX Template for Pandoc
% Inspired by the "Parsons Sample.docx" document.
%
% This template defines custom colors, fonts, heading styles, and
% headers/footers to match the branding of the sample document.
% ===================================================================
\documentclass[11pt]{article}

% --- REQUIRED PACKAGES ---
\usepackage{pdfpages}      % For \includepdf command (via Lua filter)
\usepackage{graphicx}      % For including images
\usepackage{geometry}      % For setting page margins
\usepackage{fancyhdr}      % For custom headers and footers
\usepackage{xcolor}        % For defining custom colors
\usepackage{titlesec}      % For customizing section headings
\usepackage{amsmath}       % For equations
\usepackage{longtable}     % For multi-page tables
\usepackage{booktabs}      % For professional-looking table rules
\usepackage{tcolorbox}     % For creating colored callout boxes
\usepackage{hyperref}      % For clickable links and table of contents
\usepackage[T1]{fontenc}   % For font encoding
\usepackage{helvet}        % Use Helvetica clone for a clean, sans-serif look
\renewcommand{\familydefault}{\sfdefault} % Set sans-serif as the default font

% --- PAGE GEOMETRY ---
\geometry{
    a4paper,
    left=1in,
    right=1in,
    top=1.2in,      % Increased top margin for header
    bottom=1in,
    headheight=35pt % Allocate space for the header
}

% --- COLOR DEFINITIONS (from Parsons Palette) ---
\definecolor{ParsonsSpaceBlue}{HTML}{003A70} % A dark blue
\definecolor{ParsonsSkyBlue}{HTML}{009FDF}   % A bright cyan-blue
\definecolor{ParsonsEarthGreen}{HTML}{66B512} % A vibrant green
\definecolor{ParsonsMoonGrey}{HTML}{D1D3D4}  % A light grey

% --- HYPERLINK SETUP ---
\hypersetup{
    colorlinks=true,
    linkcolor=ParsonsSpaceBlue,
    urlcolor=ParsonsSkyBlue,
    citecolor=ParsonsEarthGreen,
    pdftitle={$title$},
    pdfauthor={$author$}
}

% --- CUSTOMIZE SECTION HEADINGS ---
% \titleformat{<command>}[<shape>]{<format>}{<label>}{<sep>}{<before-code>}[<after-code>]
\titleformat{\section}
  {\normalfont\Large\bfseries\color{ParsonsSpaceBlue}} % Format
  {\thesection}                                       % Label
  {1em}                                                % Separation
  {}                                                   % Before-code
\titleformat{\subsection}
  {\normalfont\large\bfseries\color{ParsonsSpaceBlue}}
  {\thesubsection}
  {1em}
  {}
\titleformat{\subsubsection}
  {\normalfont\normalsize\bfseries\color{ParsonsSpaceBlue}}
  {\thesubsubsection}
  {1em}
  {}

% Add spacing after section titles
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% --- HEADER AND FOOTER CONFIGURATION ---
\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields

% Define a gradient line for the header (as a TikZ picture)
% This requires the tikz package, which is very common in LaTeX distributions
\usepackage{tikz}
\newcommand{\gradienthead}{%
  \begin{tikzpicture}[remember picture, overlay]
    \shade[right color=ParsonsSkyBlue, left color=ParsonsEarthGreen]
      (current page.north west) rectangle ([xshift=-0.1in]current page.north east);
  \end{tikzpicture}
}

% Header configuration
\fancyhead[L]{\textbf{\textcolor{ParsonsSpaceBlue}{PARSONS}}}
\fancyhead[R]{} % Can add project name here if needed, e.g., $if(project)$ $project$ $endif$
% Add a rule below the header text
\renewcommand{\headrulewidth}{0pt} % We use a custom rule instead
\addtolength{\headheight}{-15pt} % Adjust for custom line
\fancyhead[C]{%
\begin{tikzpicture}[remember picture, overlay]
  \shade[right color=ParsonsSkyBlue, left color=ParsonsEarthGreen]
    ([yshift=-25pt]current page.north west) rectangle ([yshift=-28pt,xshift=0.1in]current page.north east);
\end{tikzpicture}
}

% Footer configuration
\fancyfoot[C]{\color{gray}\thepage}

% --- TABLE OF CONTENTS SETUP ---
% Remove the default "Contents" title
\renewcommand{\contentsname}{}

% --- CUSTOM CALLOUT BOXES ---
% Example of a simple, styled callout box
\newtcolorbox{calloutbox}[2][]{
    colback=ParsonsMoonGrey!20, % Light grey background
    colframe=ParsonsSpaceBlue,   % Blue frame
    fonttitle=\bfseries,
    coltitle=black,
    title=#2,
    #1
}

% --- DOCUMENT BODY ---
\begin{document}

% Title block
$if(title)$
\begin{center}
    {\Huge\bfseries\color{ParsonsSpaceBlue} $title$}
    \vspace{1cm}
    $if(author)$
        {\Large $author$}
    $endif$
    \vspace{0.5cm}
    $if(date)$
        {\large $date$}
    $endif$
\end{center}
\newpage
$endif$

% Table of Contents, List of Figures, List of Tables
$if(toc)$
{
  \hypersetup{linkcolor=black} % Make TOC links black
  \begin{tcolorbox}[colback=white, colframe=ParsonsMoonGrey, title=Table of Contents]
    \tableofcontents
  \end{tcolorbox}
  \newpage
  
  $if(lof)$
    \begin{tcolorbox}[colback=white, colframe=ParsonsMoonGrey, title=List of Figures]
      \listoffigures
    \end{tcolorbox}
    \newpage
  $endif$
  
  $if(lot)$
    \begin{tcolorbox}[colback=white, colframe=ParsonsMoonGrey, title=List of Tables]
      \listoftables
    \end{tcolorbox}
    \newpage
  $endif$
}
$endif$

% This is where Pandoc will insert the main document content
$body$

\end{document}
